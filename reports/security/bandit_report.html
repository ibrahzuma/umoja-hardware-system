
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">3959</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Standard pseudo-random generators are not suitable for security/cryptographic purposes.<br>
    <b>Test ID:</b> B311<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/330.html" target="_blank">CWE-330</a><br>
    <b>File: </b><a href=".\apps\inventory\models.py" target="_blank">.\apps\inventory\models.py</a><br>
    <b>Line number: </b>49<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/blacklists/blacklist_calls.html#b311-random" target="_blank">https://bandit.readthedocs.io/en/1.9.3/blacklists/blacklist_calls.html#b311-random</a><br>

<div class="code">
<pre>
48	            while True:
49	                random_str = &#x27;&#x27;.join(random.choices(string.ascii_uppercase + string.digits, k=6))
50	                new_sku = f&quot;{prefix}-{random_str}&quot;
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'admin123'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\scripts\fix_admin_login.py" target="_blank">.\scripts\fix_admin_login.py</a><br>
    <b>Line number: </b>11<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
10	    username = &#x27;admin&#x27;
11	    password = &#x27;admin123&#x27;
12	    
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Call to requests without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href=".\scripts\reproduce_debug.py" target="_blank">.\scripts\reproduce_debug.py</a><br>
    <b>Line number: </b>11<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
10	    # 1. Fetch products to get a valid ID
11	    r_prod = requests.get(&quot;http://127.0.0.1:8000/api/products/&quot;)
12	    if r_prod.status_code == 200:
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Call to requests without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href=".\scripts\reproduce_debug.py" target="_blank">.\scripts\reproduce_debug.py</a><br>
    <b>Line number: </b>27<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
26	    # 2. Fetch branches
27	    r_branch = requests.get(&quot;http://127.0.0.1:8000/api/branches/&quot;)
28	    if r_branch.status_code == 200:
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Call to requests without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href=".\scripts\reproduce_debug.py" target="_blank">.\scripts\reproduce_debug.py</a><br>
    <b>Line number: </b>66<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
65	    print(&quot;Sending payload:&quot;, json.dumps(payload, indent=2))
66	    response = requests.post(url, json=payload)
67	    
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'allahu(SW)1'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>8<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
7	USERNAME = &quot;ibrahimu&quot;
8	PASSWORD = &quot;allahu(SW)1&quot;
9	DB_PASS = &quot;allahu(SW)1&quot;
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'allahu(SW)1'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>9<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
8	PASSWORD = &quot;allahu(SW)1&quot;
9	DB_PASS = &quot;allahu(SW)1&quot;
10	SUPERUSER_PASS = &quot;Umoja@2026&quot;
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'Umoja@2026'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
9	DB_PASS = &quot;allahu(SW)1&quot;
10	SUPERUSER_PASS = &quot;Umoja@2026&quot;
11	
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>17<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
16	    # print(f&quot;Executing: {command}&quot;)
17	    stdin, stdout, stderr = ssh.exec_command(command)
18	    
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-high">
    <b>ssh_no_host_key_verification: </b> Paramiko call with policy set to automatically trust the unknown host key.<br>
    <b>Test ID:</b> B507<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/295.html" target="_blank">CWE-295</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b507_ssh_no_host_key_verification.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b507_ssh_no_host_key_verification.html</a><br>

<div class="code">
<pre>
27	    ssh = paramiko.SSHClient()
28	    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
29	    
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
41	        print(&quot;Creating migration script on server...&quot;)
42	        shell_script = f&quot;&quot;&quot;#!/bin/bash
43	set -e
44	
45	# Function to wait for apt lock
46	wait_for_apt_lock() {{
47	    while fuser /var/lib/dpkg/lock-frontend &gt;/dev/null 2&gt;&amp;1; do
48	        echo &quot;Waiting for apt lock...&quot;
49	        sleep 5
50	    done
51	}}
52	
53	echo &quot;Starting migration process...&quot;
54	
55	# 1. Install PostgreSQL
56	wait_for_apt_lock
57	apt-get update
58	apt-get install postgresql postgresql-contrib libpq-dev -y
59	
60	# 2. Setup Database
61	echo &quot;Setting up Database...&quot;
62	sudo -u postgres psql -c &quot;CREATE DATABASE umoja_db;&quot; || echo &quot;Database might already exist&quot;
63	sudo -u postgres psql -c &quot;ALTER USER postgres WITH PASSWORD &#x27;{DB_PASS}&#x27;;&quot;
64	sudo -u postgres psql -c &quot;GRANT ALL PRIVILEGES ON DATABASE umoja_db TO postgres;&quot;
65	
66	# 3. Pull latest code
67	echo &quot;Pulling latest code...&quot;
68	cd {dir_path}
69	git fetch --all
70	git reset --hard origin/main
71	
72	# 4. Update .env
73	echo &quot;Updating .env...&quot;
74	cat &lt;&lt;EOF &gt; .env
75	DEBUG=False
76	SECRET_KEY=97mo#$70gwckll(^rf%=o%ad4y*a(93en2ya5p%7(4-^6%el8j
77	ALLOWED_HOSTS=umoja.ehub.co.tz,172.236.209.216
78	CSRF_TRUSTED_ORIGINS=https://umoja.ehub.co.tz
79	
80	DB_NAME=umoja_db
81	DB_USER=postgres
82	DB_PASSWORD=&#x27;{DB_PASS}&#x27;
83	DB_HOST=localhost
84	DB_PORT=5432
85	
86	SECURE_SSL_REDIRECT=True
87	SESSION_COOKIE_SECURE=True
88	CSRF_COOKIE_SECURE=True
89	EOF
90	
91	# 5. Migration &amp; Superuser
92	echo &quot;Running Django migrations...&quot;
93	source venv/bin/activate
94	pip install psycopg2-binary
95	python manage.py migrate --noinput
96	
97	echo &quot;Creating superuser...&quot;
98	python manage.py shell -c &quot;from django.contrib.auth import get_user_model; User = get_user_model(); User.objects.filter(username=&#x27;umoja&#x27;).delete(); User.objects.create_superuser(&#x27;umoja&#x27;, &#x27;admin@example.com&#x27;, &#x27;{SUPERUSER_PASS}&#x27;)&quot;
99	
100	# 6. Restart services
101	echo &quot;Restarting services...&quot;
102	systemctl restart django_app
103	systemctl restart nginx
104	
105	echo &quot;Migration completed successfully!&quot;
106	&quot;&quot;&quot;
107	        # Save shell script to server
</pre>
</div>


</div>
</div>

<div id="issue-11">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>108<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
107	        # Save shell script to server
108	        ssh.exec_command(f&quot;echo \&quot;{shell_script}\&quot; &gt; /tmp/migrate_to_pg.sh&quot;)
109	        ssh.exec_command(&quot;chmod +x /tmp/migrate_to_pg.sh&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-12">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>109<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
108	        ssh.exec_command(f&quot;echo \&quot;{shell_script}\&quot; &gt; /tmp/migrate_to_pg.sh&quot;)
109	        ssh.exec_command(&quot;chmod +x /tmp/migrate_to_pg.sh&quot;)
110	
</pre>
</div>


</div>
</div>

<div id="issue-13">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href=".\server_deploy.py" target="_blank">.\server_deploy.py</a><br>
    <b>Line number: </b>113<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
112	        print(&quot;Executing migration script with sudo...&quot;)
113	        status, out, err = run_remote_command(ssh, &quot;/tmp/migrate_to_pg.sh&quot;, sudo=True)
114	        
</pre>
</div>


</div>
</div>

<div id="issue-14">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\tests\test_sales_flow.py" target="_blank">.\tests\test_sales_flow.py</a><br>
    <b>Line number: </b>11<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
10	            print(&quot;Creating User...&quot;)
11	            user = User.objects.create_user(username=&#x27;testmanager&#x27;, password=&#x27;password&#x27;, role=&#x27;manager&#x27;)
12	            print(&quot;Creating Branch...&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-15">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'allahu(SW)1'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
5	USERNAME = &quot;ibrahimu&quot;
6	PASSWORD = &quot;allahu(SW)1&quot;
7	
</pre>
</div>


</div>
</div>

<div id="issue-16">
<div class="issue-block issue-sev-high">
    <b>ssh_no_host_key_verification: </b> Paramiko call with policy set to automatically trust the unknown host key.<br>
    <b>Test ID:</b> B507<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/295.html" target="_blank">CWE-295</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b507_ssh_no_host_key_verification.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b507_ssh_no_host_key_verification.html</a><br>

<div class="code">
<pre>
9	    ssh = paramiko.SSHClient()
10	    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
11	    
</pre>
</div>


</div>
</div>

<div id="issue-17">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>18<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
17	        print(&quot;1. Checking PostgreSQL service...&quot;)
18	        _, stdout, _ = ssh.exec_command(&quot;systemctl is-active postgresql&quot;)
19	        print(f&quot;   Status: {stdout.read().decode().strip()}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-18">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>25<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
24	        # We&#x27;ll use the sudo echo pattern again but carefully
25	        stdin, stdout, stderr = ssh.exec_command(f&quot;echo &#x27;{PASSWORD}&#x27; | sudo -S -u postgres psql -l&quot;)
26	        out = stdout.read().decode()
</pre>
</div>


</div>
</div>

<div id="issue-19">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
35	        print(&quot;3. Checking django_app service...&quot;)
36	        _, stdout, _ = ssh.exec_command(&quot;systemctl is-active django_app&quot;)
37	        print(f&quot;   Status: {stdout.read().decode().strip()}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-20">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>41<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
40	        print(&quot;4. Checking .env file for DB settings...&quot;)
41	        dir_exists, stdout, _ = ssh.exec_command(&quot;[ -d /var/www/app ] &amp;&amp; echo &#x27;app&#x27; || echo &#x27;umoja&#x27;&quot;)
42	        dir_name = stdout.read().decode().strip()
</pre>
</div>


</div>
</div>

<div id="issue-21">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>44<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
43	        path = f&quot;/var/www/{dir_name if dir_name == &#x27;app&#x27; else &#x27;umoja-hardware-system&#x27;}/.env&quot;
44	        stdin, stdout, stderr = ssh.exec_command(f&quot;echo &#x27;{PASSWORD}&#x27; | sudo -S grep &#x27;DB_NAME&#x27; {path}&quot;)
45	        print(f&quot;   .env check: {stdout.read().decode().strip()}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-22">
<div class="issue-block issue-sev-medium">
    <b>paramiko_calls: </b> Possible shell injection via Paramiko call, check inputs are properly sanitized.<br>
    <b>Test ID:</b> B601<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href=".\verify_server.py" target="_blank">.\verify_server.py</a><br>
    <b>Line number: </b>50<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html" target="_blank">https://bandit.readthedocs.io/en/1.9.3/plugins/b601_paramiko_calls.html</a><br>

<div class="code">
<pre>
49	        cmd = f&quot;cd /var/www/{dir_name if dir_name == &#x27;app&#x27; else &#x27;umoja-hardware-system&#x27;} &amp;&amp; source venv/bin/activate &amp;&amp; python manage.py migrate --check&quot;
50	        _, stdout, stderr = ssh.exec_command(cmd)
51	        err = stderr.read().decode()
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
